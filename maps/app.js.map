{"version":3,"sources":["app.ts"],"names":[],"mappings":";;AAQA,GAAG,CAAS;IACV,QAAQ;QAEN,IAAI,IAAI,GAAa,EAAE,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;QACrD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;QACzB,EAAE,CAAC,cAAc,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;QAGhC,EAAE,CAAC,KAAK,CAAC;YACP,OAAO,CAAC,IAAI;YAGZ,CAAC;SACF,CAAC,CAAC;QAEH,EAAE,CAAC,UAAU,CAAC;YACZ,OAAO,EAAE,CAAC,GAAG,EAAE,EAAE;gBACf,IAAI,GAAG,CAAC,WAAW,CAAC,gBAAgB,CAAC,EAAE;oBAErC,EAAE,CAAC,WAAW,CAAC;wBACb,OAAO,EAAE,CAAC,GAAG,EAAE,EAAE;4BAEf,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,GAAG,CAAC,QAAQ,CAAC;4BAGxC,IAAI,IAAI,CAAC,qBAAqB,EAAE;gCAC9B,IAAI,CAAC,qBAAqB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;6BAC1C;wBACH,CAAC;qBACF,CAAC,CAAC;iBACJ;YACH,CAAC;SACF,CAAC,CAAC;IACL,CAAC;IACD,UAAU,EAAE,EACX;CACF,CAAC,CAAC","file":"../src/app.js","sourcesContent":["// app.ts\nexport interface IMyApp {\n  globalData: {\n    userInfo?: wx.UserInfo;\n  };\n  userInfoReadyCallback?(res: wx.UserInfo): void;\n}\n\nApp<IMyApp>({\n  onLaunch() {\n    // 展示本地存储能力\n    let logs: number[] = wx.getStorageSync('logs') || [];\n    logs.unshift(Date.now());\n    wx.setStorageSync('logs', logs);\n\n    // 登录\n    wx.login({\n      success(_res) {\n        // console.log(_res.code)\n        // 发送 _res.code 到后台换取 openId, sessionKey, unionId\n      }\n    });\n    // 获取用户信息\n    wx.getSetting({\n      success: (res) => {\n        if (res.authSetting['scope.userInfo']) {\n          // 已经授权，可以直接调用 getUserInfo 获取头像昵称，不会弹框\n          wx.getUserInfo({\n            success: (res) => {\n              // 可以将 res 发送给后台解码出 unionId\n              this.globalData.userInfo = res.userInfo;\n              // 由于 getUserInfo 是网络请求，可能会在 Page.onLoad 之后才返回\n              // 所以此处加入 callback 以防止这种情况\n              if (this.userInfoReadyCallback) {\n                this.userInfoReadyCallback(res.userInfo);\n              }\n            }\n          });\n        }\n      }\n    });\n  },\n  globalData: {\n  }\n});\n"]}